<div class="row booking-manager-container" style="margin: 15px">
  <ng-container *ngFor="let booking of filteredBookings; let i = index">
    <div class="col-md-5 booking-history" *ngIf="filteredBookings.length > 0">
      <div class="table-container booking-manager-table">
        <table class="table" style="margin: 0px 0px !important">
          <thead>
            <tr class="trigger-booking-table">
              <th>Booking {{ i + 1 }}</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr class="trigger-booking-table">
              <td class="trigger-booking-td">
                <input
                  type="checkbox"
                  [id]="'triggerBooking' + booking._id"
                  name="triggerBooking"
                  [value]="booking._id"
                />
                <div class="trigger-booking-td-1">
                  <p class="p1">{{ booking.unitType }}</p>
                  <p class="p2">{{ booking._id }}</p>
                </div>
              </td>
              <td></td>
            </tr>
            <tr class="trigger-booking-table">
              <td class="trigger-booking-td">
                <input
                  type="checkbox"
                  [id]="'triggerBookingPickup' + booking._id"
                  name="triggerBooking"
                  [value]="booking._id"
                />
                <div class="trigger-booking-td-1">
                  <p class="p1">{{ booking.pickup }}</p>
                  <p class="p2">{{ booking.dropPoints.join(", ") }}</p>
                </div>
              </td>
              <td>
                <button
                  type="button"
                  class="btn btn-payNow"
                  style="width: 150px"
                >
                  Edit
                </button>
              </td>
            </tr>
            <tr class="trigger-booking-table">
              <td class="trigger-booking-td">
                <input
                  type="checkbox"
                  [id]="'triggerBookingBalance' + booking._id"
                  name="triggerBooking"
                  [value]="booking._id"
                />
                <div class="trigger-booking-td-1">
                  <p class="p1">Balance Amount</p>
                  <p class="p2">{{ booking.date }}</p>
                </div>
              </td>
              <td>
                <button
                  type="button"
                  class="btn btn-payNow"
                  style="width: 150px"
                  (click)="
                makePayment(
                  $event,
                  booking.remainingBalance || 0,
                  'Completed',
                  booking.partner,
                  booking._id
                )
              "
                >
                  Pay: {{ booking.remainingBalance }} SAR
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </ng-container>

  <div class="col-md-2 booking-history">
    <div class="table-container booking-manager-table">
      <table class="table" style="margin: 0px 0px !important">
        <thead>
          <tr class="trigger-booking-table">
            <th style="text-align: center !important">New Booking</th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <tr
              class="trigger-booking-table"
              style="cursor: pointer"
              (click)="createBooking()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="82.998"
                height="89.999"
                viewBox="0 0 82.998 89.999"
              >
                <path
                  id="Union_1"
                  data-name="Union 1"
                  d="M33,81V53H8.5a8.5,8.5,0,0,1,0-17H33V9A9,9,0,1,1,51,9V36H74.5a8.5,8.5,0,1,1,0,17H51V81a9,9,0,1,1-18,0Z"
                  transform="translate(-0.001 -0.001)"
                  fill="#b7aeb9"
                  opacity="0.394"
                />
              </svg>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="row booking-manager-container">
  <div class="col-md-12 booking-history">
    <div class="table-container booking-manager-table">
      <table class="table" style="margin: 0px 0px !important">
        <thead>
          <tr class="trigger-booking-table">
            <th>Booking ID</th>
            <th>Mode</th>
            <th>Vendor</th>
            <th>Payment Status</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <tr class="trigger-booking-table" *ngFor="let booking of bookings">
              <td>{{ booking._id }}</td>
              <td>{{ booking.unitType }}</td>
              <td>
                {{
                  booking.partner
                    ? partnerDetails[booking.partner]?.partnerName ||
                      "Loading..."
                    : "N/A"
                }}
              </td>
              <td>
                <span
                  [ngStyle]="{
                    'background-color': getPaymentStatusColor(
                      booking.paymentStatus
                    ),
                    color: getPaymentTextColor(booking.paymentStatus),
                    padding: '5px 30px',
                    'border-radius': '15px',
                    'font-size': '15px',
                    width: '230px !important' 
                  }"
                >
                  {{ booking.paymentStatus }}
                </span>
              </td>
              <td>
                <ng-container [ngSwitch]="booking.paymentStatus">
                  <img
                    *ngSwitchCase="'HalfPaid'"
                    src="assets/images/halfpaid.svg"
                    alt="Half Paid"
                  />
                  <img
                    *ngSwitchCase="'Pending'"
                    src="assets/images/pending payment.svg"
                    alt="Pending Payment"
                  />
                  <img
                    *ngSwitchCase="'Completed'"
                    src="assets/images/payment-completed.svg"
                    alt="Payment Completed"
                  />
                </ng-container>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
